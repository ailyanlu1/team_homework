\documentclass[UTF8]{ctexart}
\title{More Queries to Array...}
\author{唐适之}
\date{时间限制5s，空间限制256M}
\newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\}
\usepackage[top=1in, bottom=1in, left=1.25in, right=1.25in]{geometry}
\usepackage{enumitem}

\begin{document}

\maketitle

\myparagraph{问题描述}

你有一个包含n个整数$a_1$,$a_2$,...,$a_n$数组。你的任务是快速地执行以下两种操作。
\begin{enumerate}[leftmargin=15mm]
\item
将闭区间{[l,r]}中的元素赋值为x。即此操作过后$a_l$,$a_{l+1}$,...,$a_r$的值都为x。
\item
计算并输出和$\sum_{i=l}^r a_i \cdot (i-l+1)^k$，此处k不超过5。因为这个和可能很大，你要输出它模1000000007($10^9+7$)的结果。
\end{enumerate}

\myparagraph{输入格式}

第一行包含两个整数n和m，分别表示数组中有多少个元素以及有多少个操作

第二行包含n个整数$a_1$,$a_2$,...,$a_n$——数组中的初始元素。

接下来m行，每行是如下格式的一种：
\begin{enumerate}[leftmargin=15mm]
\item
赋值操作："= l r x"
\item
查询操作："? l r k"
\end{enumerate}

所有的输入都是整数

\myparagraph{输出格式}

对于每个询问输出询问的答案——要求的和模$10^9+7$。

\myparagraph{样例输入}

\begin{verbatim}
样例输入1

4 5
5 10 2 1
? 1 2 1
= 2 2 0
? 2 4 3
= 1 4 1
? 1 4 5

样例输入2

3 1
1000000000 1000000000 1000000000
? 1 3 0
\end{verbatim}

\myparagraph{样例输出}

\begin{verbatim}
样例输出1

25
43
1300

样例输出2

999999986
\end{verbatim}

\myparagraph{数据规模和约定}

对于10\%的数据，n≤1000。

对于30\%的数据，n≤10000。

对于50\%的数据，n≤50000。

对于另外10\%的数据，n≤100000且询问操作中k≤2。

对于100\%的数据，1≤n≤100000，初始数组中0≤$a_i$≤$10^9$。赋值操作中1≤l≤r≤n，0≤x≤$10^9$；询问操作中1≤l≤r≤n，0≤k≤5。

\end{document}
